# FIO Model→Lab Calibration Report

**Generated:** 2025-09-14 16:42:51 UTC  
**Method:** isotonic  
**Data Hash:** 9bb788c6  

## Executive Summary

This report documents the calibration of modeled fecal indicator organism (FIO) concentrations to laboratory Total Coliform measurements from government boreholes. The calibration enables transparent risk categorization and supports evidence-based decision making.

### Key Results

- **Calibration method:** isotonic  
- **Valid data pairs:** 44 out of 44 boreholes  
- **Cross-validation RMSE:** 0.9044 ± 0.1961 (log₁₀ space)  
- **Cross-validation R²:** -0.0937 ± 0.0853  
- **Spearman correlation:** -0.0581 ± 0.2928  

## Methods

### Data Preprocessing

Laboratory and model concentration values were preprocessed according to protocol:

- **Non-detect handling:** ND values substituted with 0.1 CFU/100mL  
- **"Numerous" handling:** cap_p99 policy applied  
- **ND substitutions made:** 4  
- **"Numerous" substitutions made:** 2  

### Calibration Approach

**isotonic** calibration was fitted in log₁₀ space to stabilize variance:


Isotonic regression ensures monotonic calibration without assuming linearity. The mapping is stored as 44 interpolation knots spanning the data range.

### Cross-Validation

5-fold cross-validation was used to assess calibration performance:

| Metric | Mean | Std Dev |
|--------|------|---------|
| RMSE (log₁₀) | 0.9044 | 0.1961 |
| MAE (log₁₀) | 0.7356 | 0.1491 |
| R² | -0.0937 | 0.0853 |
| Bias (log₁₀) | 0.0042 | 0.1776 |
| Spearman ρ | -0.0581 | 0.2928 |

## Data Summary

- **Model concentration range:** 164684.4 to 18787251.1 CFU/100mL  
- **Lab concentration range:** 0.1 to 58.0 CFU/100mL  

## Risk Categories

Lab-equivalent concentrations are categorized using public health-informed thresholds:

| Category | Range (CFU/100mL) | Rationale |
|----------|-------------------|-----------|
| **Low** | < 10 | Below typical detection limits |
| **Moderate** | 10 – 99 | Detectable but below concern thresholds |
| **High** | 100 – 999 | Elevated contamination |
| **Very High** | ≥ 1000 | Significant contamination requiring attention |

## Quality Assurance

- **Reproducibility:** Fixed random seed (42) ensures reproducible results  
- **Data integrity:** Input data hash 9bb788c6 enables change tracking  
- **Robust methods:** Huber regression mitigates outlier influence  

## Files Generated

1. `calibration_params.json` - Calibration parameters for application  
2. `model_vs_lab_scatter.png` - Before/after calibration diagnostic plot  
3. `calibration_report.md` - This report  

## Protocol Compliance

This calibration follows the professional protocol for model→lab calibration:

✅ **Data-driven:** Uses only observed lab data for mapping  
✅ **Monotonic:** Higher model values map to higher lab-equivalent values  
✅ **Robust:** Handles non-detects, outliers, and text-coded values  
✅ **Reproducible:** Fixed random seed, versioned parameters  
✅ **Communicable:** Anchored to recognizable public health thresholds  

---
*Report generated by FIO Model→Lab Calibration System*
